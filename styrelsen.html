<!doctype html>
<html lang="sv">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Styrelsen ‚Äî V√§sthaga Nr4</title>
<style>
:root{
  --bg:#f7f9fc;
  --card:#ffffff;
  --accent:#f09a0f;
  --muted:#6b7280;
  --maxw:1200px;
  --shadow:0 6px 18px rgba(11,18,32,0.06);
}
*{box-sizing:border-box}
body{font-family:Inter,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:0;background:var(--bg);color:#0b1220}
.container{max-width:var(--maxw);margin:24px auto;padding:16px}

/* ----- HEADER (identisk med index) ----- */
header{
  position:fixed;top:0;left:0;width:100%;padding:22px 32px;
  display:flex;align-items:center;justify-content:space-between;
  background:rgba(255,255,255,0);transition:background .3s,box-shadow .3s;
  box-shadow:none;z-index:50;
}
header.scrolled{background:#fff;box-shadow:0 4px 12px rgba(0,0,0,0.08);}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:44px;height:44px;border-radius:8px;background:var(--accent);display:flex;align-items:center;justify-content:center;cursor:pointer;}
.logo img{width:100%;height:100%;object-fit:cover;border-radius:8px;}
nav ul{list-style:none;margin:0;padding:0;display:flex;gap:4px;align-items:center;}
nav a{padding:8px 12px;border-radius:8px;text-decoration:none;color:inherit;transition:all .2s;white-space:nowrap;}
nav a:hover{background:var(--accent);color:#fff;}
.dropdown{position:relative;}
.dropdown-content{
  position:absolute;top:36px;left:0;display:none;background:#fff;border-radius:8px;
  box-shadow:0 6px 18px rgba(0,0,0,0.08);padding:8px;min-width:180px;z-index:20;
}
.dropdown.show .dropdown-content{display:block;}
.dropdown-content a{display:block;color:var(--accent);padding:6px 10px;margin:2px 0;border-radius:6px;}
.dropdown-content a:hover{background:var(--accent);color:#fff;}
.hamburger{display:none;font-size:1.8rem;cursor:pointer;user-select:none;color:var(--accent);}
@media(max-width:768px){
  .hamburger{display:block;}
  nav ul{flex-direction:column;position:fixed;top:0;right:0;width:240px;height:100%;
    background:#fff;transform:translateX(100%);transition:transform .3s ease;
    box-shadow:-4px 0 12px rgba(0,0,0,0.08);padding-top:80px;padding-left:20px;align-items:flex-start;}
  nav ul.show{transform:translateX(0);}
  nav ul li{width:100%;margin-bottom:12px;}
  nav ul li a{width:100%;text-align:left;padding-left:16px;}
  .dropdown-content{position:static;box-shadow:none;padding-left:12px;}
}

/* ----- STYRELSE-KORT ----- */
h1{text-align:center;margin-top:120px;}
h2{color:var(--accent);text-align:center;font-weight:400;margin-top:-8px;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin-top:32px;}
.card{background:var(--card);padding:20px;border-radius:12px;box-shadow:var(--shadow);
  text-align:center;position:relative;cursor:default;transition:transform .2s;}
.card.dragging{opacity:.6;transform:scale(0.97);}
.card h3{margin:12px 0 4px 0;color:var(--accent);}
.card p.position{margin:0 0 8px 0;font-weight:600;color:#333;}
.card ul{list-style:disc;padding-left:20px;text-align:left;margin:6px 0;color:#555;}
.card-img-wrapper{width:100%;height:220px;overflow:hidden;border-radius:10px;}
.card-img-wrapper img{width:100%;height:100%;object-fit:cover;object-position:center;}
.card .edit-btn,.card .delete-btn{
  position:absolute;top:8px;right:8px;background:none;border:none;cursor:pointer;
  font-size:1.1rem;color:var(--accent);transition:.2s;}
.card .delete-btn{top:auto;bottom:8px;}
.card .edit-btn:hover,.card .delete-btn:hover{color:#d27c0c;}
.add-card-btn{
  position:fixed;bottom:24px;right:24px;width:56px;height:56px;
  background:var(--accent);color:#fff;border-radius:50%;display:none;
  justify-content:center;align-items:center;font-size:28px;cursor:pointer;z-index:60;
  box-shadow:0 4px 12px rgba(0,0,0,0.15);}
.add-card-btn:hover{background:#d27c0c;}

/* ----- SAVE/PUBLISH FLOATING ----- */
.save-publish{
  position:fixed;bottom:24px;right:100px;z-index:70;display:none;gap:10px;
}
.save-publish button{
  border:none;border-radius:8px;padding:10px 16px;font-weight:600;cursor:pointer;
  transition:.2s;
}
#saveBtn{background:var(--accent);color:#fff;}
#saveBtn:hover{background:#d27c0c;}
#cancelBtn{background:#e5e7eb;color:#111;}
#cancelBtn:hover{background:#d1d5db;}

/* ----- EDIT OVERLAY ----- */
.edit-overlay{
  position:fixed;top:0;left:0;width:100%;height:100%;display:none;
  justify-content:center;align-items:center;background:rgba(0,0,0,0.45);z-index:100;
}
.editor{background:#fff;padding:24px;border-radius:10px;max-width:480px;width:100%;
  display:flex;flex-direction:column;gap:10px;}
.editor input,.editor textarea{padding:8px;border:1px solid #ccc;border-radius:6px;font-size:1rem;}
.editor label{font-weight:600;color:#333;}
.editor button{padding:10px;border:none;border-radius:6px;font-weight:600;cursor:pointer;}
.editor .btn-primary{background:var(--accent);color:#fff;}
.editor .btn-secondary{background:#fff;color:var(--accent);border:1px solid var(--accent);}
.editor .btn-cancel{background:#e5e7eb;}
footer{text-align:center;color:var(--muted);margin:40px 0 20px;font-size:.9rem;}
</style>
</head>
<body>

<header id="mainHeader">
  <div class="brand">
    <a href="index.html" class="logo"><img src="logga.png" alt="Logga"></a>
    <a href="index.html" style="text-decoration:none;color:inherit;display:flex;flex-direction:column;">
      <div style="font-weight:700;font-size:1.5rem;">V√§sthaga Nr4</div>
      <div class="muted" style="font-size:1rem;">Bostadsr√§ttsf√∂rening</div>
    </a>
  </div>
  <nav>
    <div class="hamburger" id="hamburger">‚ò∞</div>
    <ul id="mainNav">
      <li><a href="index.html">Hem</a></li>
      <li class="dropdown">
        <a href="om.html">Om f√∂reningen ‚ñæ</a>
        <div class="dropdown-content">
          <a href="om.html">Om oss</a>
          <a href="stadgar.html">Stadgar</a>
        </div>
      </li>
      <li class="dropdown">
        <a href="styrelsen.html">Styrelsen ‚ñæ</a>
        <div class="dropdown-content">
          <a href="styrelsen.html">Styrelsen</a>
          <a href="styrelseninformerar.html">Styrelsen informerar</a>
        </div>
      </li>
      <li class="dropdown">
        <a href="#">Planeringsprojekt ‚ñæ</a>
        <div class="dropdown-content">
          <a href="pagaendeplaner.html">P√•g√•ende planer</a>
          <a href="utfordaplaner.html">Utf√∂rda planer</a>
        </div>
      </li>
      <li><a href="felanmalan.html">Felanm√§lan</a></li>
      <li><a href="loggain.html">Logga in</a></li>
      <li id="adminNav" style="display:none;"><a href="admin.html">Admin</a></li>
    </ul>
  </nav>
</header>

<div class="container">
  <h1>Styrelsen f√∂r V√§sthaga Nr4</h1>
  <h2>Styrelsen best√•r av 6 personer framr√∂stade p√• √•rsst√§mman.</h2>
  <main class="grid" id="cardGrid"></main>
</div>

<div class="add-card-btn" id="addCardBtn">+</div>

<div class="save-publish" id="savePublish">
  <button id="saveBtn">Spara och publicera</button>
  <button id="cancelBtn">Avbryt</button>
</div>

<div class="edit-overlay" id="editOverlay">
  <div class="editor">
    <label>Namn</label>
    <input type="text" id="editName" placeholder="Namn">
    <label>Position</label>
    <input type="text" id="editPosition" placeholder="Position (t.ex. Ordf√∂rande)">
    <label>Ansvarsomr√•den</label>
    <textarea id="editResponsibilities" rows="3" placeholder="Lista, separerad med kommatecken"></textarea>
    <label>Bild</label>
    <input type="file" id="fileUpload" accept="image/*">
    <button id="removeImageBtn" class="btn-secondary" type="button">Ta bort bild</button>
    <div style="display:flex;gap:8px;justify-content:flex-end;">
      <button id="applyEditBtn" class="btn-primary">Till√§mpa √§ndring</button>
      <button id="cancelEditBtn" class="btn-cancel">Avbryt</button>
    </div>
  </div>
</div>

<footer>&copy; V√§sthaga Nr4 ‚Äî Bostadsr√§ttsf√∂rening</footer>

<script>
/* ========== HEADER SCROLL + DROPDOWN LOGIK ========== */
const header=document.getElementById("mainHeader");
const mainNav=document.getElementById("mainNav");
const hamburger=document.getElementById("hamburger");
const dropdowns=document.querySelectorAll(".dropdown");
hamburger.addEventListener("click",()=>{mainNav.classList.toggle("show");hamburger.textContent=mainNav.classList.contains("show")?"‚û§":"‚ò∞";});
window.addEventListener("scroll",()=>{if(window.scrollY>100)header.classList.add("scrolled");else header.classList.remove("scrolled");});
dropdowns.forEach(d=>{
  const link=d.querySelector("a");
  d.addEventListener("mouseenter",()=>{dropdowns.forEach(o=>o.classList.remove("show"));d.classList.add("show");});
  d.addEventListener("mouseleave",()=>{setTimeout(()=>d.classList.remove("show"),200);});
});
document.addEventListener("click",e=>{if(!e.target.closest(".dropdown"))dropdowns.forEach(d=>d.classList.remove("show"));});

/* ========== ADMIN LOGIK ========== */
const currentUser=JSON.parse(localStorage.getItem("currentUser")||"null");
const adminMode=currentUser&&currentUser.role==="admin";
if(adminMode)document.getElementById("adminNav").style.display="block";

const grid=document.getElementById("cardGrid");
const addBtn=document.getElementById("addCardBtn");
const savePanel=document.getElementById("savePublish");
const saveBtn=document.getElementById("saveBtn");
const cancelBtn=document.getElementById("cancelBtn");

const overlay=document.getElementById("editOverlay");
const nameInput=document.getElementById("editName");
const posInput=document.getElementById("editPosition");
const respInput=document.getElementById("editResponsibilities");
const fileInput=document.getElementById("fileUpload");
const removeImgBtn=document.getElementById("removeImageBtn");

let editingIndex=null;
let dragSrcIndex=null;
let defaultImages=["female.png","male.png"];
let cards=JSON.parse(localStorage.getItem("styrelseCards")||"null")||[
  {name:"Marie Nordin",position:"Ordf√∂rande",responsibilities:["Ekonomi","Nyckelhantering","Porttelefoni"],image:"female.png"},
  {name:"Cerin Benyamin",position:"Vice ordf√∂rande",responsibilities:["Ekonomi","Tv√§ttstuga"],image:"female.png"},
  {name:"Karin √ñman",position:"Sekreterare",responsibilities:["Informationstavla","Yttre & Inre st√§d"],image:"female.png"},
  {name:"Tomas Stockhaus",position:"Ledamot",responsibilities:["Namn√§ndringar","Yttre milj√∂"],image:"male.png"},
  {name:"Torbj√∂rn Lundqvist",position:"Ledamot",responsibilities:["Parkeringar","Yttre milj√∂"],image:"male.png"},
  {name:"Alojz Zvar",position:"Suppleant",responsibilities:[],image:"male.png"}
];

function renderCards(){
  grid.innerHTML="";
  cards.forEach((c,i)=>{
    const card=document.createElement("div");
    card.className="card";
    card.draggable=adminMode;
    card.dataset.index=i;
    card.innerHTML=`
      <div class="card-img-wrapper"><img src="${c.image||defaultImages[i%2]}" alt="${c.name}"></div>
      <h3>${c.name}</h3>
      <p class="position">${c.position}</p>
      <ul>${(c.responsibilities||[]).map(r=>`<li>${r}</li>`).join("")}</ul>
    `;
    if(adminMode){
      const ebtn=document.createElement("button");ebtn.className="edit-btn";ebtn.textContent="‚úèÔ∏è";
      ebtn.onclick=()=>openEditor(i);
      const dbtn=document.createElement("button");dbtn.className="delete-btn";dbtn.textContent="üóëÔ∏è";
      dbtn.onclick=()=>{cards.splice(i,1);showSave();renderCards();};
      card.append(ebtn,dbtn);
      // Drag handlers
      card.addEventListener("dragstart",ev=>{dragSrcIndex=i;card.classList.add("dragging");});
      card.addEventListener("dragend",ev=>{card.classList.remove("dragging");});
      card.addEventListener("dragover",ev=>{
        ev.preventDefault();
        const target=ev.currentTarget;
        const targetIndex=parseInt(target.dataset.index);
        if(targetIndex!==dragSrcIndex){
          const dragged=cards.splice(dragSrcIndex,1)[0];
          cards.splice(targetIndex,0,dragged);
          dragSrcIndex=targetIndex;
          renderCards();
          showSave();
        }
      });
    }
    grid.appendChild(card);
  });
  addBtn.style.display=adminMode?"flex":"none";
}
renderCards();

function showSave(){savePanel.style.display="flex";}
function hideSave(){savePanel.style.display="none";}

addBtn.onclick=()=>{
  const img=defaultImages[cards.length%2];
  cards.push({name:"Nytt namn",position:"Titel",responsibilities:[],image:img});
  renderCards();showSave();
};

function openEditor(i){
  editingIndex=i;
  const c=cards[i];
  nameInput.value=c.name;
  posInput.value=c.position;
  respInput.value=c.responsibilities.join(", ");
  fileInput.value="";
  overlay.style.display="flex";
}
removeImgBtn.onclick=()=>{
  if(editingIndex!==null){
    const i=editingIndex;
    cards[i].image=defaultImages[i%2];
    renderCards();showSave();
  }
};
fileInput.onchange=(e)=>{
  const file=e.target.files[0];if(!file)return;
  const reader=new FileReader();
  reader.onload=ev=>{
    if(editingIndex!==null){
      cards[editingIndex].image=ev.target.result;
      showSave();
    }
  };
  reader.readAsDataURL(file);
};
document.getElementById("applyEditBtn").onclick=()=>{
  if(editingIndex===null)return;
  const i=editingIndex;
  cards[i].name=nameInput.value.trim();
  cards[i].position=posInput.value.trim();
  cards[i].responsibilities=respInput.value.split(",").map(x=>x.trim()).filter(x=>x);
  overlay.style.display="none";
  renderCards();showSave();editingIndex=null;
};
document.getElementById("cancelEditBtn").onclick=()=>{overlay.style.display="none";editingIndex=null;};

saveBtn.onclick=()=>{
  localStorage.setItem("styrelseCards",JSON.stringify(cards));
  hideSave();
  alert("√Ñndringar sparade!");
};
cancelBtn.onclick=()=>{
  cards=JSON.parse(localStorage.getItem("styrelseCards")||"null")||cards;
  renderCards();hideSave();
  overlay.style.display="none";
};

overlay.addEventListener("click",e=>{if(e.target===overlay){overlay.style.display="none";}});
</script>
</body>
</html>
